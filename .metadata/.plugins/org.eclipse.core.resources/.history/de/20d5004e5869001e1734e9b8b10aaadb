package application.controller;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

import org.sqlite.SQLiteDataSource;

import javafx.scene.control.DatePicker;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import java.time.LocalDate; 

public class DatabaseController {
	private SQLiteDataSource getDataSource() {
        SQLiteDataSource ds = null;

        try {
            ds = new SQLiteDataSource();
            ds.setUrl("jdbc:sqlite:test.db");
        } catch ( Exception e ) {
            e.printStackTrace();
            System.exit(0);
        }
        
        return ds;
	}
	
    void openDatabase() {
        try (Connection conn =
                DriverManager.getConnection("jdbc:sqlite:test.db");
            ) {
        } catch (Exception e) {
            e.printStackTrace();
            System.exit(0);
        }
        System.out.println("Opened database successfully");
    }
    
    void createTable() {
        SQLiteDataSource ds = getDataSource();
        String query = "CREATE TABLE IF NOT EXISTS projectTable ( " +
                "ID INTEGER AUTO_INCREMENT PRIMARY KEY, " +
        		"STRING NAME, " +
                "CREATED DATE, " +
                "DESCRIPTION TEXT)";


        try ( Connection conn = ds.getConnection();
              Statement stmt = conn.createStatement(); ) {
              stmt.executeUpdate( query );
              System.out.println( "Created database successfully" );
        } catch ( SQLException e ) {
            e.printStackTrace();
            System.exit( 0 );
        }
    }
    
    void insertProject(TextField nameField, DatePicker dateField, TextArea descriptionField) {
    	String name = nameField.getText();
    	LocalDate date = dateField.getValue();
    	String text = descriptionField.getText();
    	
    	String query = "INSERT INTO projectTable (NAME, DATE, DESCRIPTION) " +
    			"VALUES (" + name + ", " + date + ", " + text + ")";
    	System.out.println("query: " + query);
    	
    }
}
